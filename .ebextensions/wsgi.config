container_commands:
  01_requirement:
    command: "pip install -r requirements/dev.txt"
    test: '[ "$DJANGO_SETTINGS_MODULE" = "settings.dev" ]'
  02_requirement_dev:
    command: "pip install -r requirements/production.txt"
    test: '[ "$DJANGO_SETTINGS_MODULE" = "settings.production" ]'
  03_wsgipass:
    command: 'echo "WSGIPassAuthorization On" >> ../wsgi.conf'
  04_migrate:
    command: "django-admin.py migrate"
    leader_only: true
commands:
  WSGIPassAuthorization:
    command: sed -i.bak '/WSGIScriptAlias/ a WSGIPassAuthorization On' config.py
    cwd: /opt/elasticbeanstalk/hooks
  03_command:
    command: yum install --assumeyes zlib fontconfig freetype X11
  04_command:
    command: wget https://downloads.wkhtmltopdf.org/0.12/0.12.4/wkhtmltox-0.12.4_linux-generic-amd64.tar.xz
  05_command:
    command: tar -xJf wkhtmltox-0.12.4_linux-generic-amd64.tar.xz
  06_command:
    command: cp wkhtmltox/bin/wkhtmltopdf /usr/local/bin/wkhtmltopdf
  07_command:
    command: cp wkhtmltox/bin/wkhtmltoimage /usr/local/bin/wkhtmltoimage
